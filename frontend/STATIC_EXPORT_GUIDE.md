# Galaxy ERP é™æ€å¯¼å‡ºéƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•å°† Galaxy ERP å‰ç«¯é¡¹ç›®é…ç½®ä¸ºæ”¯æŒé™æ€å¯¼å‡ºéƒ¨ç½²ï¼Œä»¥åŠç›¸å…³çš„ä¼˜åŒ–ç­–ç•¥å’Œéƒ¨ç½²æ–¹æ³•ã€‚

## ğŸ”§ é™æ€å¯¼å‡ºé…ç½®

### 1. Layout.tsx ä¼˜åŒ–

å·²å¯¹ `app/layout.tsx` è¿›è¡Œä»¥ä¸‹ä¼˜åŒ–ï¼š

#### âœ… é™æ€å…ƒæ•°æ®é…ç½®
```typescript
export const metadata: Metadata = {
  title: 'GalaxyERP - ä¼ä¸šèµ„æºè§„åˆ’ç³»ç»Ÿ',
  description: 'Galaxy ERP å‰ç«¯ - ç°ä»£åŒ–ä¼ä¸šèµ„æºè§„åˆ’ç³»ç»Ÿ',
  // ... å®Œæ•´çš„ SEO å’Œ PWA å…ƒæ•°æ®
};
```

#### âœ… å®¢æˆ·ç«¯é‡å®šå‘å¤„ç†
- ä½¿ç”¨ `ClientRedirect` ç»„ä»¶æ›¿ä»£æœåŠ¡å™¨ç«¯é‡å®šå‘
- æ”¯æŒè®¤è¯çŠ¶æ€æ£€æŸ¥å’Œè·¯ç”±ä¿æŠ¤
- å®Œå…¨å…¼å®¹é™æ€å¯¼å‡º

#### âœ… PWA æ”¯æŒ
- æ·»åŠ äº† manifest.json å¼•ç”¨
- é…ç½®äº†å›¾æ ‡å’Œä¸»é¢˜è‰²
- æ”¯æŒç¦»çº¿è®¿é—®

### 2. Next.js é…ç½®

#### æ ‡å‡†é…ç½® (next.config.js)
```javascript
// åŠ¨æ€é…ç½®ï¼Œæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼
// output: 'standalone', // Docker éƒ¨ç½²
// output: 'export',     // é™æ€å¯¼å‡º
```

#### é™æ€å¯¼å‡ºä¸“ç”¨é…ç½® (next.config.static.js)
```javascript
const nextConfig = {
  output: 'export',              // å¯ç”¨é™æ€å¯¼å‡º
  trailingSlash: true,           // æ·»åŠ å°¾éƒ¨æ–œæ 
  images: { unoptimized: true }, // ç¦ç”¨å›¾ç‰‡ä¼˜åŒ–
  // ... å…¶ä»–é™æ€å¯¼å‡ºä¼˜åŒ–é…ç½®
};
```

### 3. å®¢æˆ·ç«¯è·¯ç”±å¤„ç†

#### ClientRedirect ç»„ä»¶ç‰¹æ€§
- **è®¤è¯æ£€æŸ¥**: è‡ªåŠ¨æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
- **è·¯ç”±ä¿æŠ¤**: æœªç™»å½•ç”¨æˆ·é‡å®šå‘åˆ°ç™»å½•é¡µ
- **è¿”å› URL**: ç™»å½•åè¿”å›åŸè®¿é—®é¡µé¢
- **åŠ è½½çŠ¶æ€**: è®¤è¯çŠ¶æ€åŠ è½½æœŸé—´æ˜¾ç¤ºåŠ è½½ç•Œé¢

#### æ”¯æŒçš„è·¯ç”±é€»è¾‘
```typescript
// å…¬å¼€é¡µé¢ï¼ˆæ— éœ€è®¤è¯ï¼‰
const publicPaths = ['/login', '/register'];

// å—ä¿æŠ¤é¡µé¢ï¼ˆéœ€è¦è®¤è¯ï¼‰
// æ‰€æœ‰å…¶ä»–é¡µé¢éƒ½éœ€è¦ç™»å½•
```

## ğŸš€ æ„å»ºå’Œéƒ¨ç½²

### 1. æ„å»ºå‘½ä»¤

```bash
# ä½¿ç”¨é™æ€å¯¼å‡ºé…ç½®æ„å»º
npm run build:static

# æˆ–ä½¿ç”¨ä¸“ç”¨å¯¼å‡ºå‘½ä»¤
npm run export:static

# æ¸…ç†å¹¶é‡æ–°æ„å»º
npm run clean:static
```

### 2. é¢„è§ˆé™æ€æ–‡ä»¶

```bash
# æœ¬åœ°é¢„è§ˆé™æ€å¯¼å‡ºç»“æœ
npm run preview:static

# è®¿é—® http://localhost:3000 æŸ¥çœ‹æ•ˆæœ
```

### 3. éƒ¨ç½²ç›®æ ‡

#### CDN éƒ¨ç½²
```bash
# æ„å»ºé™æ€æ–‡ä»¶
npm run build:static

# ä¸Šä¼  out/ ç›®å½•åˆ° CDN
aws s3 sync out/ s3://your-bucket --delete
```

#### Nginx éƒ¨ç½²
```nginx
server {
    listen 80;
    server_name your-domain.com;
    root /path/to/out;
    index index.html;
    
    # SPA è·¯ç”±æ”¯æŒ
    location / {
        try_files $uri $uri/ $uri.html /index.html;
    }
    
    # é™æ€èµ„æºç¼“å­˜
    location /_next/static/ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

## ğŸ“Š é™æ€å¯¼å‡ºä¼˜åŠ¿

### 1. æ€§èƒ½ä¼˜åŠ¿
- **é›¶æœåŠ¡å™¨å»¶è¿Ÿ**: çº¯é™æ€æ–‡ä»¶ï¼Œæ— æœåŠ¡å™¨å¤„ç†æ—¶é—´
- **CDN åŠ é€Ÿ**: å…¨çƒåˆ†å‘ï¼Œå°±è¿‘è®¿é—®
- **ç¼“å­˜å‹å¥½**: é™æ€èµ„æºå¯é•¿æœŸç¼“å­˜

### 2. éƒ¨ç½²ä¼˜åŠ¿
- **ç®€å•éƒ¨ç½²**: åªéœ€ä¸Šä¼ é™æ€æ–‡ä»¶
- **ä½æˆæœ¬**: æ— éœ€æœåŠ¡å™¨è¿è¡Œæˆæœ¬
- **é«˜å¯ç”¨**: é™æ€æ–‡ä»¶å¤©ç„¶é«˜å¯ç”¨

### 3. SEO ä¼˜åŠ¿
- **é¢„æ¸²æŸ“**: æ‰€æœ‰é¡µé¢åœ¨æ„å»ºæ—¶é¢„æ¸²æŸ“
- **å®Œæ•´å…ƒæ•°æ®**: é™æ€ HTML åŒ…å«å®Œæ•´ SEO ä¿¡æ¯
- **å¿«é€ŸåŠ è½½**: æå‡æœç´¢å¼•æ“æ’å

## âš ï¸ é™æ€å¯¼å‡ºé™åˆ¶

### 1. åŠŸèƒ½é™åˆ¶
- **æ—  API Routes**: ä¸æ”¯æŒ Next.js API è·¯ç”±
- **æ— æœåŠ¡å™¨å‡½æ•°**: ä¸æ”¯æŒ `getServerSideProps`
- **æ— åŠ¨æ€é‡å®šå‘**: é‡å®šå‘éœ€è¦åœ¨å®¢æˆ·ç«¯å¤„ç†

### 2. è§£å†³æ–¹æ¡ˆ
- **å¤–éƒ¨ API**: ä½¿ç”¨ç‹¬ç«‹çš„åç«¯ API æœåŠ¡
- **å®¢æˆ·ç«¯æ¸²æŸ“**: åŠ¨æ€å†…å®¹åœ¨å®¢æˆ·ç«¯è·å–
- **å®¢æˆ·ç«¯è·¯ç”±**: ä½¿ç”¨ React Router å¤„ç†è·¯ç”±

## ğŸ”„ ç¯å¢ƒåˆ‡æ¢

### å¼€å‘ç¯å¢ƒ
```bash
# æ ‡å‡†å¼€å‘æ¨¡å¼
npm run dev
```

### é™æ€å¯¼å‡ºæµ‹è¯•
```bash
# æ„å»ºé™æ€ç‰ˆæœ¬
npm run build:static

# æœ¬åœ°é¢„è§ˆ
npm run preview:static
```

### ç”Ÿäº§éƒ¨ç½²
```bash
# æ ¹æ®éƒ¨ç½²æ–¹å¼é€‰æ‹©
./deploy.sh static    # é™æ€å¯¼å‡º
./deploy.sh docker    # Docker éƒ¨ç½²
./deploy.sh standalone # ç‹¬ç«‹éƒ¨ç½²
```

## ğŸ›  æ•…éšœæ’é™¤

### 1. æ„å»ºé”™è¯¯

#### å›¾ç‰‡ä¼˜åŒ–é”™è¯¯
```bash
# é”™è¯¯: Image Optimization using Next.js' default loader is not compatible with `output: 'export'`
# è§£å†³: åœ¨ next.config.static.js ä¸­è®¾ç½® images.unoptimized: true
```

#### åŠ¨æ€è·¯ç”±é”™è¯¯
```bash
# é”™è¯¯: Dynamic routes are not supported with `output: 'export'`
# è§£å†³: ä½¿ç”¨ exportPathMap é¢„å®šä¹‰æ‰€æœ‰è·¯ç”±
```

### 2. è¿è¡Œæ—¶é”™è¯¯

#### è·¯ç”±é—®é¢˜
```bash
# é—®é¢˜: åˆ·æ–°é¡µé¢ 404
# è§£å†³: é…ç½®æœåŠ¡å™¨æ”¯æŒ SPA è·¯ç”±å›é€€
```

#### API è°ƒç”¨å¤±è´¥
```bash
# é—®é¢˜: API è°ƒç”¨ç›¸å¯¹è·¯å¾„é”™è¯¯
# è§£å†³: ä½¿ç”¨å®Œæ•´çš„ API URL (NEXT_PUBLIC_API_URL)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. æ„å»ºä¼˜åŒ–
```javascript
// next.config.static.js
experimental: {
  optimizePackageImports: ['antd', '@ant-design/icons'],
},
```

### 2. èµ„æºä¼˜åŒ–
```javascript
// å¯ç”¨å‹ç¼©
compress: true,
// ç¦ç”¨ä¸å¿…è¦çš„å¤´éƒ¨
poweredByHeader: false,
generateEtags: false,
```

### 3. ç¼“å­˜ç­–ç•¥
```nginx
# Nginx ç¼“å­˜é…ç½®
location /_next/static/ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}

location /static/ {
    expires 30d;
    add_header Cache-Control "public";
}
```

## ğŸ” ç›‘æ§å’Œåˆ†æ

### 1. æ„å»ºåˆ†æ
```bash
# åˆ†ææ„å»ºåŒ…å¤§å°
npm run build:analyze
```

### 2. æ€§èƒ½ç›‘æ§
- ä½¿ç”¨ Lighthouse æ£€æŸ¥æ€§èƒ½
- ç›‘æ§ Core Web Vitals
- åˆ†æåŠ è½½æ—¶é—´å’Œäº¤äº’æ€§

### 3. ç”¨æˆ·ä½“éªŒ
- é…ç½® PWA ç¦»çº¿æ”¯æŒ
- å®ç°åŠ è½½çŠ¶æ€æŒ‡ç¤º
- ä¼˜åŒ–é¦–å±æ¸²æŸ“æ—¶é—´

## ğŸ“ æœ€ä½³å®è·µ

1. **å®šæœŸæµ‹è¯•**: æ¯æ¬¡å‘å¸ƒå‰æµ‹è¯•é™æ€å¯¼å‡º
2. **æ€§èƒ½ç›‘æ§**: æŒç»­ç›‘æ§é¡µé¢æ€§èƒ½æŒ‡æ ‡
3. **ç¼“å­˜ç­–ç•¥**: åˆç†é…ç½®é™æ€èµ„æºç¼“å­˜
4. **é”™è¯¯å¤„ç†**: å®Œå–„çš„å®¢æˆ·ç«¯é”™è¯¯å¤„ç†
5. **ç”¨æˆ·ä½“éªŒ**: ä¼˜åŒ–åŠ è½½çŠ¶æ€å’Œäº¤äº’åé¦ˆ

---

é€šè¿‡ä»¥ä¸Šé…ç½®å’Œä¼˜åŒ–ï¼ŒGalaxy ERP å‰ç«¯é¡¹ç›®å·²å®Œå…¨æ”¯æŒé™æ€å¯¼å‡ºéƒ¨ç½²ï¼Œå¯ä»¥äº«å—é™æ€ç½‘ç«™çš„æ‰€æœ‰ä¼˜åŠ¿ï¼ŒåŒæ—¶ä¿æŒç°ä»£ SPA åº”ç”¨çš„ç”¨æˆ·ä½“éªŒã€‚